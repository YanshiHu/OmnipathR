<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="OmnipathR">
<title>Pathway construction • OmnipathR</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Pathway construction">
<meta property="og:description" content="OmnipathR">
<meta property="og:image" content="https://saezlab.github.io/OmnipathR/logo.svg">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-119440867-10"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-119440867-10');
</script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">OmnipathR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">3.11.10</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/bioc_workshop.html">OmniPath Bioconductor workshop</a>
    <a class="dropdown-item" href="../articles/db_manager.html">The database manager in OmnipathR</a>
    <a class="dropdown-item" href="../articles/drug_targets.html">Building protein networks around drug-targets using OmnipathR</a>
    <a class="dropdown-item" href="../articles/extra_attrs.html">Resource specific interaction attributes</a>
    <a class="dropdown-item" href="../articles/gene_ontology.html">Gene Ontology in OmnipathR</a>
    <a class="dropdown-item" href="../articles/nichenet.html">Using NicheNet with OmnipathR</a>
    <a class="dropdown-item" href="../articles/omnipath_intro.html">OmnipathR: an R client for the OmniPath web service</a>
    <a class="dropdown-item" href="../articles/paths.html">Pathway construction</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/saezlab/OmnipathR/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://twitter.com/omnipathdb">
    <span class="fab fa fab fa-twitter fa-lg"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://omnipathdb.org/">
    <span class="fas fa fas fa-university"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Pathway construction</h1>
                        <h4 data-toc-skip class="author">Denes
Turei</h4>
            <address class="author_afil">
      Institute for Computational Biomedicine, Heidelberg
University<br><a class="author_email" href="mailto:#"></a><a href="mailto:turei.denes@gmail.com" class="email">turei.denes@gmail.com</a>
      </address>
                  
      
      <small class="dont-index">Source: <a href="https://github.com/saezlab/OmnipathR/blob/HEAD/vignettes/paths.Rmd" class="external-link"><code>vignettes/paths.Rmd</code></a></small>
      <div class="d-none name"><code>paths.Rmd</code></div>
    </div>

    
        <div class="abstract">
      <p class="abstract">Abstract</p>
      <p>Constructing possible pathways according to certain biological
      constraints is one popular use of pathway databases. Here we show
      how to create de novo pathways using subcellular localization and
      molecular function constraints. In this example, the pathways
      should start from extracellular ligands, trigger intracellular
      cascades via a plasma membrane receptor, and end on transcription
      factors. Just to have an example, we use a pathway from SignaLink
      as genes of interest, and try to de novo reconstruct this pathway
      from other resources in OmniPath.</p>
    </div>
    
<div class="section level2">
<h2 id="preparing-inputs">Preparing inputs<a class="anchor" aria-label="anchor" href="#preparing-inputs"></a>
</h2>
<p>In this tutorial we use Gene Symbols (HGNC symbols) as primary
identifiers just to maintain better human readability across all
intermediate steps, however the same procedure can be done with UniProt
IDs, and this latter is more preferable.</p>
<div class="section level3">
<h3 id="transcription-factors">Transcription factors<a class="anchor" aria-label="anchor" href="#transcription-factors"></a>
</h3>
<p>The endpoints of pathways are transcription factors (TFs). We obtain
a list of TFs from Vaquerizas et al. 2009, the so called TF census:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r.omnipathdb.org/" class="external-link">OmnipathR</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://magrittr.tidyverse.org" class="external-link">magrittr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Attaching package: 'dplyr'</span></span></code></pre>
<pre><code><span><span class="co">## The following objects are masked from 'package:stats':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     filter, lag</span></span></code></pre>
<pre><code><span><span class="co">## The following objects are masked from 'package:base':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     intersect, setdiff, setequal, union</span></span></code></pre>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tfcensus</span> <span class="op">&lt;-</span></span>
<span>    <span class="fu"><a href="../reference/import_omnipath_annotations.html">import_omnipath_annotations</a></span><span class="op">(</span></span>
<span>        resources <span class="op">=</span> <span class="st">'TFcensus'</span>,</span>
<span>        entity_types <span class="op">=</span> <span class="st">'protein'</span></span>
<span>    <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">genesymbol</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="va">unique</span></span></code></pre></div>
<p>Alternatively we can directly download the same dataset, but
retrieving data from OmniPath is preferable most of the times:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://purrr.tidyverse.org/" class="external-link">purrr</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Attaching package: 'purrr'</span></span></code></pre>
<pre><code><span><span class="co">## The following object is masked from 'package:magrittr':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     set_names</span></span></code></pre>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tfcensus_direct</span> <span class="op">&lt;-</span></span>
<span>    <span class="fu"><a href="../reference/tfcensus_download.html">tfcensus_download</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">`HGNC symbol`</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://purrr.tidyverse.org/reference/keep.html" class="external-link">discard</a></span><span class="op">(</span><span class="va">is.na</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="va">unique</span></span></code></pre></div>
<p>Another way to obtain a list of TFs is to collect the proteins with
known regulons (target genes). We can download the TF-target
interactions from OmniPath and collect all proteins which are source of
any of these interactions.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tfs_from_network</span> <span class="op">&lt;-</span></span>
<span>    <span class="fu"><a href="../reference/import_transcriptional_interactions.html">import_transcriptional_interactions</a></span><span class="op">(</span></span>
<span>        <span class="co"># confidence levels;</span></span>
<span>        <span class="co"># we use only the 3 levels with highest confidence</span></span>
<span>        dorothea_levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'A'</span>, <span class="st">'B'</span>, <span class="st">'C'</span><span class="op">)</span>,</span>
<span>        entity_types <span class="op">=</span> <span class="st">'protein'</span></span>
<span>    <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">source_genesymbol</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="va">unique</span></span></code></pre></div>
<p>The latest method resulted only around 600 TFs, however 97 of these
are not in TF census. Maybe a good solution is to use the union of these
and TF census:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tfs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://generics.r-lib.org/reference/setops.html" class="external-link">union</a></span><span class="op">(</span><span class="va">tfcensus</span>, <span class="va">tfs_from_network</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="protein-localizations">Protein localizations<a class="anchor" aria-label="anchor" href="#protein-localizations"></a>
</h3>
<p>OmniPath contains a few resources providing subcellular localization
data. We present here a three of them:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">localizations</span> <span class="op">&lt;-</span></span>
<span>    <span class="fu"><a href="../reference/import_omnipath_annotations.html">import_omnipath_annotations</a></span><span class="op">(</span></span>
<span>        resources <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>            <span class="st">'Ramilowski_location'</span>,</span>
<span>            <span class="st">'UniProt_location'</span>,</span>
<span>            <span class="st">'HPA_subcellular'</span></span>
<span>        <span class="op">)</span>,</span>
<span>        entity_types <span class="op">=</span> <span class="st">'protein'</span>,</span>
<span>        wide <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>    <span class="op">)</span></span></code></pre></div>
<p>Checking how many proteins are covered in each of these
resources:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">localizations</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span><span class="va">x</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">genesymbol</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="va">n_distinct</span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## $HPA_subcellular</span></span>
<span><span class="co">## [1] 6937</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $Ramilowski_location</span></span>
<span><span class="co">## [1] 18852</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $UniProt_location</span></span>
<span><span class="co">## [1] 16928</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="ligands-and-receptors">Ligands and receptors<a class="anchor" aria-label="anchor" href="#ligands-and-receptors"></a>
</h3>
<p>The <em>Intercell</em> database of OmniPath is a comprehensive
resource of cell-cell communication roles. We obtain a set of ligands,
receptors, and as alternatives we create a sets of transmitters and
receivers, which are broader categories, generalizations of the former
two. After loading each of these datasets, we print the number of unique
proteins.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ligands</span> <span class="op">&lt;-</span></span>
<span>    <span class="fu">OmnipathR</span><span class="fu">::</span><span class="fu"><a href="../reference/import_omnipath_intercell.html">import_omnipath_intercell</a></span><span class="op">(</span></span>
<span>        parent <span class="op">=</span> <span class="st">'ligand'</span>,</span>
<span>        topology <span class="op">=</span> <span class="st">'sec'</span>,</span>
<span>        consensus_percentile <span class="op">=</span> <span class="fl">50</span>,</span>
<span>        loc_consensus_percentile <span class="op">=</span> <span class="fl">30</span>,</span>
<span>        entity_types <span class="op">=</span> <span class="st">'protein'</span></span>
<span>    <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">genesymbol</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="va">unique</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/tee.html" class="external-link">%T&gt;%</a></span></span>
<span>    <span class="va">length</span></span>
<span></span>
<span><span class="va">receptors</span> <span class="op">&lt;-</span></span>
<span>    <span class="fu">OmnipathR</span><span class="fu">::</span><span class="fu"><a href="../reference/import_omnipath_intercell.html">import_omnipath_intercell</a></span><span class="op">(</span></span>
<span>        parent <span class="op">=</span> <span class="st">'receptor'</span>,</span>
<span>        topology <span class="op">=</span> <span class="st">'pmtm'</span>,</span>
<span>        consensus_percentile <span class="op">=</span> <span class="fl">50</span>,</span>
<span>        loc_consensus_percentile <span class="op">=</span> <span class="fl">30</span>,</span>
<span>        entity_types <span class="op">=</span> <span class="st">'protein'</span></span>
<span>    <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">genesymbol</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="va">unique</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/tee.html" class="external-link">%T&gt;%</a></span></span>
<span>    <span class="va">length</span></span>
<span></span>
<span><span class="va">transmitters</span> <span class="op">&lt;-</span></span>
<span>    <span class="fu">OmnipathR</span><span class="fu">::</span><span class="fu"><a href="../reference/import_omnipath_intercell.html">import_omnipath_intercell</a></span><span class="op">(</span></span>
<span>        causality <span class="op">=</span> <span class="st">'trans'</span>,</span>
<span>        topology <span class="op">=</span> <span class="st">'sec'</span>,</span>
<span>        consensus_percentile <span class="op">=</span> <span class="fl">50</span>,</span>
<span>        loc_consensus_percentile <span class="op">=</span> <span class="fl">30</span>,</span>
<span>        entity_types <span class="op">=</span> <span class="st">'protein'</span></span>
<span>    <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">genesymbol</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="va">unique</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/tee.html" class="external-link">%T&gt;%</a></span></span>
<span>    <span class="va">length</span></span>
<span></span>
<span><span class="va">receivers</span> <span class="op">&lt;-</span></span>
<span>    <span class="fu">OmnipathR</span><span class="fu">::</span><span class="fu"><a href="../reference/import_omnipath_intercell.html">import_omnipath_intercell</a></span><span class="op">(</span></span>
<span>        causality <span class="op">=</span> <span class="st">'rec'</span>,</span>
<span>        topology <span class="op">=</span> <span class="st">'pmtm'</span>,</span>
<span>        consensus_percentile <span class="op">=</span> <span class="fl">50</span>,</span>
<span>        loc_consensus_percentile <span class="op">=</span> <span class="fl">30</span>,</span>
<span>        entity_types <span class="op">=</span> <span class="st">'protein'</span></span>
<span>    <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">genesymbol</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="va">unique</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/tee.html" class="external-link">%T&gt;%</a></span></span>
<span>    <span class="va">length</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="protein-protein-interactions">Protein-protein interactions<a class="anchor" aria-label="anchor" href="#protein-protein-interactions"></a>
</h3>
<p>The protein-protein interactions in OmniPath come from many resources
and are divided into 4 major datasets (<code>omnipath</code>,
<code>pathwayextra</code>, <code>kinaseextra</code> and
<code>ligrecextra</code>). We can try our procedure with any combination
of these, or even select only some resources within them. Here, for the
sake of simplicity, we use only the core <code>omnipath</code> PPI
dataset, which contains only literature curated, causal
interactions.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ppi</span> <span class="op">&lt;-</span></span>
<span>    <span class="fu"><a href="../reference/import_omnipath_interactions.html">import_omnipath_interactions</a></span><span class="op">(</span></span>
<span>        datasets <span class="op">=</span> <span class="st">'omnipath'</span>,</span>
<span>        entity_types <span class="op">=</span> <span class="st">'protein'</span></span>
<span>    <span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="example-pathways-from-literature">Example pathways from literature<a class="anchor" aria-label="anchor" href="#example-pathways-from-literature"></a>
</h3>
<p>Many databases contains curated canonical pathways, such as SIGNOR,
KEGG or SignaLink. SignaLink pathways have been curated by experts from
ligands to TFs, and the proteins are annotated as ligands, receptors,
mediators, scaffolds, co-factors and TFs. For this reason, we use
SignaLink pathways in this demonstration.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">signalink_pathways</span> <span class="op">&lt;-</span></span>
<span>    <span class="fu"><a href="../reference/import_omnipath_annotations.html">import_omnipath_annotations</a></span><span class="op">(</span></span>
<span>        resources <span class="op">=</span> <span class="st">'SignaLink_pathway'</span>,</span>
<span>        entity_types <span class="op">=</span> <span class="st">'protein'</span>,</span>
<span>        wide <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span><span class="va">signalink_functions</span> <span class="op">&lt;-</span></span>
<span>    <span class="fu"><a href="../reference/import_omnipath_annotations.html">import_omnipath_annotations</a></span><span class="op">(</span></span>
<span>        resources <span class="op">=</span> <span class="st">'SignaLink_function'</span>,</span>
<span>        entity_types <span class="op">=</span> <span class="st">'protein'</span>,</span>
<span>        wide <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>    <span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="pathway-construction-i-">Pathway construction I.<a class="anchor" aria-label="anchor" href="#pathway-construction-i-"></a>
</h2>
<div class="section level3">
<h3 id="genes-of-interest">Genes of interest<a class="anchor" aria-label="anchor" href="#genes-of-interest"></a>
</h3>
<p>In this example, we use the ligands of the SignaLink TGF-beta pathway
as genes of interest, which will be the starting point of the paths:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ligands_of_interest</span> <span class="op">&lt;-</span></span>
<span>    <span class="fu"><a href="https://generics.r-lib.org/reference/setops.html" class="external-link">intersect</a></span><span class="op">(</span></span>
<span>        <span class="va">signalink_pathways</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>            <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">pathway</span> <span class="op">==</span> <span class="st">'TGF'</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>            <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">genesymbol</span><span class="op">)</span>,</span>
<span>        <span class="va">signalink_functions</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>            <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">`function`</span> <span class="op">==</span> <span class="st">'Ligand'</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>            <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">genesymbol</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/tee.html" class="external-link">%T&gt;%</a></span></span>
<span>    <span class="va">length</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="creating-a-ppi-graph">Creating a PPI graph<a class="anchor" aria-label="anchor" href="#creating-a-ppi-graph"></a>
</h3>
<p>The data frame of interactions has to be converted to an igraph graph
object, because the <code>find_all_paths</code> function works on this
kind of object.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ppi_graph</span> <span class="op">&lt;-</span></span>
<span>    <span class="va">ppi</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="va">interaction_graph</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="looking-up-the-paths">Looking up the paths<a class="anchor" aria-label="anchor" href="#looking-up-the-paths"></a>
</h3>
<p>Searching paths in the graph, we have to define the source and target
nodes and the maximum length of the paths. The source nodes will be the
ligands of the TGF-beta pathway, the target nodes the TFs, and the
maximum path length I set to 3. This latter results paths of 3 edges,
connecting 4 nodes. The more numerous are the source and target node
sets, the longer is the maximum length, the longer it takes to look up
all the paths.</p>
<p>First we make sure we use only the ligands and TFs which are part of
this network:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r.igraph.org/" class="external-link">igraph</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Attaching package: 'igraph'</span></span></code></pre>
<pre><code><span><span class="co">## The following objects are masked from 'package:purrr':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     compose, simplify</span></span></code></pre>
<pre><code><span><span class="co">## The following objects are masked from 'package:dplyr':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     as_data_frame, groups, union</span></span></code></pre>
<pre><code><span><span class="co">## The following objects are masked from 'package:stats':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     decompose, spectrum</span></span></code></pre>
<pre><code><span><span class="co">## The following object is masked from 'package:base':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     union</span></span></code></pre>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ligands_of_interest__in_network</span> <span class="op">&lt;-</span></span>
<span>    <span class="va">ligands_of_interest</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://purrr.tidyverse.org/reference/keep.html" class="external-link">keep</a></span><span class="op">(</span><span class="va">.</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://r.igraph.org/reference/V.html" class="external-link">V</a></span><span class="op">(</span><span class="va">ppi_graph</span><span class="op">)</span><span class="op">$</span><span class="va">name</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tfs__in_network</span> <span class="op">&lt;-</span></span>
<span>    <span class="va">tfs</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://purrr.tidyverse.org/reference/keep.html" class="external-link">keep</a></span><span class="op">(</span><span class="va">.</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://r.igraph.org/reference/V.html" class="external-link">V</a></span><span class="op">(</span><span class="va">ppi_graph</span><span class="op">)</span><span class="op">$</span><span class="va">name</span><span class="op">)</span></span></code></pre></div>
<p>Then we look up the paths, this might take a few minutes:</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">paths</span> <span class="op">&lt;-</span></span>
<span>    <span class="va">ppi_graph</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/find_all_paths.html">find_all_paths</a></span><span class="op">(</span></span>
<span>        start <span class="op">=</span> <span class="va">ligands_of_interest__in_network</span>,</span>
<span>        end <span class="op">=</span> <span class="va">tfs__in_network</span>,</span>
<span>        maxlen <span class="op">=</span> <span class="fl">3</span>,</span>
<span>        attr <span class="op">=</span> <span class="st">'name'</span></span>
<span>    <span class="op">)</span></span></code></pre></div>
<p>A <code>maxlen</code> of 2 resulted around 600 paths, increasing the
length only by 1 results 15,173 paths and takes ca. 10 min to run. A
length of 4 probably would be still feasible, but might result millions
of paths and hours of computation time.</p>
</div>
<div class="section level3">
<h3 id="applying-constraints-on-the-paths">Applying constraints on the paths<a class="anchor" aria-label="anchor" href="#applying-constraints-on-the-paths"></a>
</h3>
<p>All the resulted paths start at a ligand and end on a TF, but we need
to make sure that the intermediate nodes meet the desired constraints:
the second node is a plasma membrane receptor, the mediators are located
in the cytoplasm, etc.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># only selecting Cytoplasm, of course we could</span></span>
<span><span class="co"># consider other intracellular compartments</span></span>
<span><span class="va">in_cytoplasm</span> <span class="op">&lt;-</span></span>
<span>    <span class="va">localizations</span><span class="op">$</span><span class="va">UniProt_location</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">location</span> <span class="op">==</span> <span class="st">'Cytoplasm'</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">genesymbol</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="va">unique</span></span>
<span></span>
<span><span class="va">in_nucleus</span> <span class="op">&lt;-</span></span>
<span>    <span class="va">localizations</span><span class="op">$</span><span class="va">UniProt_location</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">location</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Nucleus'</span>, <span class="st">'Nucleolus'</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">genesymbol</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="va">unique</span></span>
<span></span>
<span><span class="va">paths_selected</span> <span class="op">&lt;-</span></span>
<span>    <span class="va">paths</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="co"># removing single node paths</span></span>
<span>    <span class="fu"><a href="https://purrr.tidyverse.org/reference/keep.html" class="external-link">discard</a></span><span class="op">(</span></span>
<span>        <span class="kw">function</span><span class="op">(</span><span class="va">p</span><span class="op">)</span><span class="op">{</span></span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span> <span class="op">==</span> <span class="fl">1</span></span>
<span>        <span class="op">}</span></span>
<span>    <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="co"># receptors are plasma membrane transmembrane</span></span>
<span>    <span class="co"># according to our query to OmniPath</span></span>
<span>    <span class="fu"><a href="https://purrr.tidyverse.org/reference/keep.html" class="external-link">keep</a></span><span class="op">(</span></span>
<span>        <span class="kw">function</span><span class="op">(</span><span class="va">p</span><span class="op">)</span><span class="op">{</span></span>
<span>            <span class="va">p</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">receptors</span></span>
<span>        <span class="op">}</span></span>
<span>    <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="co"># making sure all further mediators are</span></span>
<span>    <span class="co"># in the cytoplasm</span></span>
<span>    <span class="fu"><a href="https://purrr.tidyverse.org/reference/keep.html" class="external-link">keep</a></span><span class="op">(</span></span>
<span>        <span class="kw">function</span><span class="op">(</span><span class="va">p</span><span class="op">)</span><span class="op">{</span></span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/all.html" class="external-link">all</a></span><span class="op">(</span><span class="va">p</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">tail</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://magrittr.tidyverse.org/reference/aliases.html" class="external-link">is_in</a></span><span class="op">(</span><span class="va">in_cytoplasm</span><span class="op">)</span><span class="op">)</span></span>
<span>        <span class="op">}</span></span>
<span>    <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="co"># the last nodes are all TFs, implying that they are in the nucleus</span></span>
<span>    <span class="co"># but we can optionally filter foall(p %&gt;% tail(-2)r this too:</span></span>
<span>    <span class="fu"><a href="https://purrr.tidyverse.org/reference/keep.html" class="external-link">keep</a></span><span class="op">(</span></span>
<span>        <span class="kw">function</span><span class="op">(</span><span class="va">p</span><span class="op">)</span><span class="op">{</span></span>
<span>            <span class="fu"><a href="https://dplyr.tidyverse.org/reference/nth.html" class="external-link">last</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">in_nucleus</span></span>
<span>        <span class="op">}</span></span>
<span>    <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="co"># finally, we can remove paths which contain TFs also as intermediate</span></span>
<span>    <span class="co"># nodes as these are redundant</span></span>
<span>    <span class="fu"><a href="https://purrr.tidyverse.org/reference/keep.html" class="external-link">discard</a></span><span class="op">(</span></span>
<span>        <span class="kw">function</span><span class="op">(</span><span class="va">p</span><span class="op">)</span><span class="op">{</span></span>
<span>            <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/any.html" class="external-link">any</a></span><span class="op">(</span><span class="va">p</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://magrittr.tidyverse.org/reference/aliases.html" class="external-link">is_in</a></span><span class="op">(</span><span class="va">tfs</span><span class="op">)</span><span class="op">)</span></span>
<span>        <span class="op">}</span></span>
<span>    <span class="op">)</span></span></code></pre></div>
<p>Out of the 15,173 paths, 2,045 (~13%) meet these criteria. 43 of the
paths consist of 3 nodes (ligand-&gt;receptor-&gt;TF), while 2,002 of 4
nodes (ligand-&gt;receptor-&gt;mediator-&gt;TF):</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">paths_selected</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="va">length</span></span>
<span></span>
<span><span class="va">paths_selected</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map_int</a></span><span class="op">(</span><span class="va">length</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="va">table</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="pathway-construction-ii-">Pathway construction II.<a class="anchor" aria-label="anchor" href="#pathway-construction-ii-"></a>
</h2>
<div class="section level3">
<h3 id="networks">Networks<a class="anchor" aria-label="anchor" href="#networks"></a>
</h3>
<p>We have seen <code>find_all_paths</code> is limited in efficiency. A
more convenient method could be to use only data frames and
<code>dplyr</code>’s <code>join</code> methods to build the paths. This
comes with the advantage that even more efficient backends are available
for <code>dplyr</code>, such as <code>dtplyr</code>
(<code>data.frame</code> backend) or <code>dbplyr</code> (relational
DBMS backends), hence if needed the performance can be easily
improved.</p>
<p>In <code>OmnipathR</code> we have already a dedicated function for
creating ligand-receptor (or transmitter-receiver) interactions, we can
use this as a first step. For simplicity, here we limited the query to
ligand-receptor interactions and do a simple filtering to select high
confidence ones (mostly based on consensus across resources).
Alternatively, one can fine tune better the parameters to
<code>import_intercell_network</code>, or call it without any
parameters, and use <code>filter_intercell_network</code> for quality
filtering. At the end we use <code>simplify_intercell_network</code> to
get rid of redundant columns.</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ligand_receptor</span> <span class="op">&lt;-</span></span>
<span>    <span class="fu"><a href="../reference/import_intercell_network.html">import_intercell_network</a></span><span class="op">(</span></span>
<span>        ligand_receptor <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>        high_confidence <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>        entity_types <span class="op">=</span> <span class="st">'protein'</span></span>
<span>    <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="va">simplify_intercell_network</span></span></code></pre></div>
<p>We query the TF-target gene interactions into another data frame:</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tf_target</span> <span class="op">&lt;-</span></span>
<span>    <span class="fu"><a href="../reference/import_transcriptional_interactions.html">import_transcriptional_interactions</a></span><span class="op">(</span></span>
<span>        <span class="co"># confidence levels;</span></span>
<span>        <span class="co"># we use only the 2 levels with highest confidence</span></span>
<span>        dorothea_levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'A'</span>, <span class="st">'B'</span><span class="op">)</span>,</span>
<span>        <span class="co"># I added this only to have less interactions so the</span></span>
<span>        <span class="co"># examples here run faster; feel free to remove it,</span></span>
<span>        <span class="co"># then you will have more gene regulatory interactions</span></span>
<span>        <span class="co"># from a variety of databases</span></span>
<span>        datasets <span class="op">=</span> <span class="st">'tf_target'</span>,</span>
<span>        entity_types <span class="op">=</span> <span class="st">'protein'</span>,</span>
<span>        <span class="co"># A workaround to mitigate a temporary issue (05/01/2022)</span></span>
<span>        resources <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'ORegAnno'</span>, <span class="st">'PAZAR'</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning in omnipath_check_param(param): The following resources are not</span></span>
<span><span class="co">## available: PAZAR. Check the resource names for spelling mistakes.</span></span></code></pre>
<p>The PPI network we already have in the <code>ppi</code> data frame,
we loaded it in the previous section. If you missed it, you can load it
like this:</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ppi</span> <span class="op">&lt;-</span></span>
<span>    <span class="fu"><a href="../reference/import_omnipath_interactions.html">import_omnipath_interactions</a></span><span class="op">(</span></span>
<span>        datasets <span class="op">=</span> <span class="st">'omnipath'</span>,</span>
<span>        entity_types <span class="op">=</span> <span class="st">'protein'</span></span>
<span>    <span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="annotations">Annotations<a class="anchor" aria-label="anchor" href="#annotations"></a>
</h3>
<p>As a next step, we add <em>UniProt</em> localization annotations to
the network data frames, except the ligand-receptor data frame, as this
is created in a way that all ligands are extracellular and all receptors
are plasma membrane transmembrane. In addition, we also add kinase
annotations from the <em>kinase.com</em> resource, just to showcase
working with multiple annotations. One protein might have multiple
localizations and belong to multiple kinase families. We transform the
localization and kinase family columns to list columns, which means one
field might contain more than one values.</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ppi</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/compound.html" class="external-link">%&lt;&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/annotated_network.html">annotated_network</a></span><span class="op">(</span><span class="st">'UniProt_location'</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/annotated_network.html">annotated_network</a></span><span class="op">(</span><span class="st">'kinase.com'</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="co"># these columns define a unique interaction; 5 of them would be enough</span></span>
<span>    <span class="co"># for only the grouping, we include the rest only to keep them after</span></span>
<span>    <span class="co"># the summarize statement</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span></span>
<span>        <span class="va">source</span>,</span>
<span>        <span class="va">target</span>,</span>
<span>        <span class="va">source_genesymbol</span>,</span>
<span>        <span class="va">target_genesymbol</span>,</span>
<span>        <span class="va">is_directed</span>,</span>
<span>        <span class="va">is_stimulation</span>,</span>
<span>        <span class="va">is_inhibition</span>,</span>
<span>        <span class="va">sources</span>,</span>
<span>        <span class="va">references</span>,</span>
<span>        <span class="va">curation_effort</span>,</span>
<span>        <span class="va">n_references</span>,</span>
<span>        <span class="va">n_resources</span></span>
<span>    <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span></span>
<span>        location_source <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">location_source</span><span class="op">)</span><span class="op">)</span>,</span>
<span>        location_target <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">location_target</span><span class="op">)</span><span class="op">)</span>,</span>
<span>        family_source <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">family_source</span><span class="op">)</span><span class="op">)</span>,</span>
<span>        family_target <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">family_target</span><span class="op">)</span><span class="op">)</span>,</span>
<span>        subfamily_source <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">subfamily_source</span><span class="op">)</span><span class="op">)</span>,</span>
<span>        subfamily_target <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">subfamily_target</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="va">ungroup</span></span></code></pre></div>
<pre><code><span><span class="co">## `summarise()` has grouped output by 'source', 'target', 'source_genesymbol',</span></span>
<span><span class="co">## 'target_genesymbol', 'is_directed', 'is_stimulation', 'is_inhibition',</span></span>
<span><span class="co">## 'sources', 'references', 'curation_effort', 'n_references'. You can override</span></span>
<span><span class="co">## using the `.groups` argument.</span></span></code></pre>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tf_target</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/compound.html" class="external-link">%&lt;&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/annotated_network.html">annotated_network</a></span><span class="op">(</span><span class="st">'UniProt_location'</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/annotated_network.html">annotated_network</a></span><span class="op">(</span><span class="st">'kinase.com'</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span></span>
<span>        <span class="va">source</span>,</span>
<span>        <span class="va">target</span>,</span>
<span>        <span class="va">source_genesymbol</span>,</span>
<span>        <span class="va">target_genesymbol</span>,</span>
<span>        <span class="va">is_directed</span>,</span>
<span>        <span class="va">is_stimulation</span>,</span>
<span>        <span class="va">is_inhibition</span>,</span>
<span>        <span class="va">sources</span>,</span>
<span>        <span class="va">references</span>,</span>
<span>        <span class="va">curation_effort</span>,</span>
<span>        <span class="co"># Workaround to mitigate a temporary issue with</span></span>
<span>        <span class="co"># DoRothEA data in OmniPath (05/01/2022)</span></span>
<span>        <span class="co"># dorothea_level,</span></span>
<span>        <span class="va">n_references</span>,</span>
<span>        <span class="va">n_resources</span></span>
<span>    <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span></span>
<span>        location_source <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">location_source</span><span class="op">)</span><span class="op">)</span>,</span>
<span>        location_target <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">location_target</span><span class="op">)</span><span class="op">)</span>,</span>
<span>        family_source <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">family_source</span><span class="op">)</span><span class="op">)</span>,</span>
<span>        family_target <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">family_target</span><span class="op">)</span><span class="op">)</span>,</span>
<span>        subfamily_source <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">subfamily_source</span><span class="op">)</span><span class="op">)</span>,</span>
<span>        subfamily_target <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">subfamily_target</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="va">ungroup</span></span></code></pre></div>
<pre><code><span><span class="co">## `summarise()` has grouped output by 'source', 'target', 'source_genesymbol',</span></span>
<span><span class="co">## 'target_genesymbol', 'is_directed', 'is_stimulation', 'is_inhibition',</span></span>
<span><span class="co">## 'sources', 'references', 'curation_effort', 'n_references'. You can override</span></span>
<span><span class="co">## using the `.groups` argument.</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="building-paths">Building paths<a class="anchor" aria-label="anchor" href="#building-paths"></a>
</h3>
<p>We build the paths starting from the ligand-receptor interactions,
joining the PPI interactions repeatedly until we reach the desired path
length. After each step we throw away the paths which contain loops; set
aside the paths which end in a TF; and keep growing the rest of the
paths. At the end, we add the gene regulatory interactions to the end of
each path, making all paths start in an extracellular ligand and end in
a TF target gene. In each step we add suffixes to the column names:
<code>_step1</code>, <code>_step2</code>, and so on, to ensure the
attributes of each step can be recognized. Each step will extend the
width of the data frame by around 20 columns. We could reduce this by
dropping certain variables. First, we define the set of TFs:</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tfs</span> <span class="op">&lt;-</span></span>
<span>    <span class="va">tf_target</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">source_genesymbol</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="va">unique</span></span></code></pre></div>
<p>For the repetitive task of growing paths we define a function:</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rlang.r-lib.org" class="external-link">rlang</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Attaching package: 'rlang'</span></span></code></pre>
<pre><code><span><span class="co">## The following object is masked from 'package:igraph':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     is_named</span></span></code></pre>
<pre><code><span><span class="co">## The following objects are masked from 'package:purrr':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     %@%, flatten, flatten_chr, flatten_dbl, flatten_int, flatten_lgl,</span></span>
<span><span class="co">##     flatten_raw, invoke, splice</span></span></code></pre>
<pre><code><span><span class="co">## The following object is masked from 'package:magrittr':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     set_names</span></span></code></pre>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyselect.r-lib.org" class="external-link">tidyselect</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">grow_paths</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">paths</span>, <span class="va">step</span>, <span class="va">interactions</span>, <span class="va">endpoints</span> <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span><span class="op">{</span></span>
<span></span>
<span>    <span class="va">right_target_col</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span></span>
<span>        <span class="st">'target_genesymbol_step%i'</span>,</span>
<span>        <span class="va">step</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span>    <span class="va">paths</span><span class="op">$</span><span class="va">growing</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/compound.html" class="external-link">%&lt;&gt;%</a></span> <span class="fu">one_step</span><span class="op">(</span><span class="va">step</span>, <span class="va">interactions</span><span class="op">)</span></span>
<span></span>
<span>    <span class="co"># finished paths with their last node being an endpoint:</span></span>
<span>    <span class="va">paths</span><span class="op">[[</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">'step%i'</span>, <span class="va">step</span><span class="op">)</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>        <span class="va">paths</span><span class="op">$</span><span class="va">growing</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>        <span class="op">{</span><span class="fu">`if`</span><span class="op">(</span></span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">endpoints</span><span class="op">)</span>,</span>
<span>            <span class="va">.</span>,</span>
<span>            <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">.</span>, <span class="op">!</span><span class="op">!</span><span class="fu"><a href="https://rlang.r-lib.org/reference/sym.html" class="external-link">sym</a></span><span class="op">(</span><span class="va">right_target_col</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">endpoints</span><span class="op">)</span></span>
<span>        <span class="op">)</span><span class="op">}</span></span>
<span></span>
<span>    <span class="co"># paths to be further extended:</span></span>
<span>    <span class="va">paths</span><span class="op">$</span><span class="va">growing</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/compound.html" class="external-link">%&lt;&gt;%</a></span></span>
<span>        <span class="op">{</span><span class="fu">`if`</span><span class="op">(</span></span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">endpoints</span><span class="op">)</span>,</span>
<span>            <span class="cn">NULL</span>,</span>
<span>            <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">.</span>, <span class="op">!</span><span class="op">(</span><span class="op">!</span><span class="op">!</span><span class="fu"><a href="https://rlang.r-lib.org/reference/sym.html" class="external-link">sym</a></span><span class="op">(</span><span class="va">right_target_col</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">endpoints</span><span class="op">)</span><span class="op">)</span></span>
<span>        <span class="op">)</span><span class="op">}</span></span>
<span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/invisible.html" class="external-link">invisible</a></span><span class="op">(</span><span class="va">paths</span><span class="op">)</span></span>
<span></span>
<span><span class="op">}</span></span>
<span></span>
<span></span>
<span><span class="va">one_step</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">paths</span>, <span class="va">step</span>, <span class="va">interactions</span><span class="op">)</span><span class="op">{</span></span>
<span></span>
<span>    <span class="va">left_col</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">'target_genesymbol_step%i'</span>, <span class="va">step</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span></span>
<span>    <span class="va">right_col</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">'source_genesymbol_step%i'</span>, <span class="va">step</span><span class="op">)</span></span>
<span>    <span class="va">by</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/setNames.html" class="external-link">setNames</a></span><span class="op">(</span><span class="va">right_col</span>, <span class="va">left_col</span><span class="op">)</span></span>
<span></span>
<span>    <span class="va">paths</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="co"># making sure even at the first step we have the suffix `_step1`</span></span>
<span>    <span class="op">{</span><span class="fu">`if`</span><span class="op">(</span></span>
<span>        <span class="st">'target_genesymbol'</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span>,</span>
<span>        <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename_with</a></span><span class="op">(</span></span>
<span>            <span class="va">.</span>,</span>
<span>            <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">'%s_step%i'</span>, <span class="va">x</span>, <span class="va">step</span><span class="op">)</span><span class="op">}</span></span>
<span>        <span class="op">)</span>,</span>
<span>        <span class="va">.</span></span>
<span>    <span class="op">)</span><span class="op">}</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="op">{</span><span class="fu">`if`</span><span class="op">(</span></span>
<span>        <span class="va">step</span> <span class="op">==</span> <span class="fl">0</span>,</span>
<span>        <span class="va">.</span>,</span>
<span>        <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">inner_join</a></span><span class="op">(</span></span>
<span>            <span class="va">.</span>,</span>
<span>            <span class="co"># adding suffix for the next step</span></span>
<span>            <span class="va">interactions</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>            <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename_with</a></span><span class="op">(</span><span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">'%s_step%i'</span>, <span class="va">x</span>, <span class="va">step</span><span class="op">)</span><span class="op">}</span><span class="op">)</span>,</span>
<span>            by <span class="op">=</span> <span class="va">by</span></span>
<span>        <span class="op">)</span></span>
<span>    <span class="op">)</span><span class="op">}</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="co"># removing loops</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">.</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">contains</a></span><span class="op">(</span><span class="st">'_genesymbol'</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>        <span class="fu"><a href="https://purrr.tidyverse.org/reference/pmap.html" class="external-link">pmap_lgl</a></span><span class="op">(</span><span class="kw">function</span><span class="op">(</span><span class="va">...</span><span class="op">)</span><span class="op">{</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/any.html" class="external-link">any</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/duplicated.html" class="external-link">duplicated</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">...</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">}</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>This function seems to be useful, after some refactoring I will add
it to <code>OmnipathR</code>. But now let’s use it for building the
paths. First, using <code>reduce</code>, we call the previously defined
function repeatedly according to the desired number of steps. After, we
go through the collections of paths of various lengths, and add the last
step, the TF-target interactions. This procedure is extremely
<strong>memory intensive,</strong> if you run it with 3 steps, make sure
you have at least 12G of free memory. Higher number of steps (longer
paths) require even more memory. Of course this can be mitigated by
removing some columns, adding less annotations, or using smaller
networks (more stringent queries or subsequent filtering).</p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://stringr.tidyverse.org" class="external-link">stringr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">steps</span> <span class="op">&lt;-</span> <span class="fl">2</span> <span class="co"># to avoid OOM</span></span>
<span></span>
<span><span class="va">paths</span> <span class="op">&lt;-</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">steps</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://purrr.tidyverse.org/reference/reduce.html" class="external-link">reduce</a></span><span class="op">(</span></span>
<span>        <span class="va">grow_paths</span>,</span>
<span>        interactions <span class="op">=</span> <span class="va">ppi</span>,</span>
<span>        endpoints <span class="op">=</span> <span class="va">tfs</span>,</span>
<span>        .init <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>            growing <span class="op">=</span> <span class="va">ligand_receptor</span></span>
<span>        <span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">within</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">growing</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://purrr.tidyverse.org/reference/map2.html" class="external-link">map2</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_extract.html" class="external-link">str_extract</a></span><span class="op">(</span><span class="st">'\\d+$'</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="va">as.integer</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://magrittr.tidyverse.org/reference/aliases.html" class="external-link">add</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>,</span>
<span>        <span class="va">one_step</span>,</span>
<span>        interactions <span class="op">=</span> <span class="va">tf_target</span></span>
<span>    <span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="technical-information">Technical information<a class="anchor" aria-label="anchor" href="#technical-information"></a>
</h2>
<div class="section level3">
<h3 id="dependencies">Dependencies<a class="anchor" aria-label="anchor" href="#dependencies"></a>
</h3>
<p>Here is a list of all packages used in this vignette:</p>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r.omnipathdb.org/" class="external-link">OmnipathR</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://magrittr.tidyverse.org" class="external-link">magrittr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://purrr.tidyverse.org/" class="external-link">purrr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r.igraph.org/" class="external-link">igraph</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rlang.r-lib.org" class="external-link">rlang</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyselect.r-lib.org" class="external-link">tidyselect</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://stringr.tidyverse.org" class="external-link">stringr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/rstudio/rmarkdown" class="external-link">rmarkdown</a></span><span class="op">)</span></span></code></pre></div>
<p>This way you can make sure all these packages are installed:</p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">missing_packages</span> <span class="op">&lt;-</span></span>
<span>    <span class="fu"><a href="https://generics.r-lib.org/reference/setops.html" class="external-link">setdiff</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>            <span class="st">'magrittr'</span>,</span>
<span>            <span class="st">'dplyr'</span>,</span>
<span>            <span class="st">'purrr'</span>,</span>
<span>            <span class="st">'igraph'</span>,</span>
<span>            <span class="st">'rlang'</span>,</span>
<span>            <span class="st">'tidyselect'</span>,</span>
<span>            <span class="st">'stringr'</span>,</span>
<span>            <span class="st">'rmarkdown'</span>,</span>
<span>            <span class="st">'devtools'</span></span>
<span>        <span class="op">)</span>,</span>
<span>        <span class="fu"><a href="https://rdrr.io/r/utils/installed.packages.html" class="external-link">installed.packages</a></span><span class="op">(</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span><span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">missing_packages</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="va">missing_packages</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="st">'OmnipathR'</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/utils/installed.packages.html" class="external-link">installed.packages</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://devtools.r-lib.org/" class="external-link">devtools</a></span><span class="op">)</span></span>
<span>    <span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">'saezlab/OmnipathR'</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="how-to-compile">How to compile<a class="anchor" aria-label="anchor" href="#how-to-compile"></a>
</h3>
<p>This is an <code>Rmd</code> (R markdown) document, a popular
reporting format for R. You can generate various document formats from
it, such as HTML or PDF, using the <code>render</code> function from the
<code>rmarkdown</code> package:</p>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/rstudio/rmarkdown" class="external-link">rmarkdown</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://pkgs.rstudio.com/rmarkdown/reference/render.html" class="external-link">render</a></span><span class="op">(</span><span class="st">'paths.Rmd'</span>, output_format <span class="op">=</span> <span class="st">'html_document'</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="session-information">Session information<a class="anchor" aria-label="anchor" href="#session-information"></a>
</h3>
<p>Below you find information about the operating system, R version and
all the loaded packages and their versions from an R session where this
vignette run without errors. This can be useful for troubleshooting, as
different software versions are one possible cause of errors.</p>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## R version 4.3.2 (2023-10-31)</span></span>
<span><span class="co">## Platform: x86_64-pc-linux-gnu (64-bit)</span></span>
<span><span class="co">## Running under: Arch Linux</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Matrix products: default</span></span>
<span><span class="co">## BLAS:   /usr/lib/libblas.so.3.12.0 </span></span>
<span><span class="co">## LAPACK: /usr/lib/liblapack.so.3.12.0</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## locale:</span></span>
<span><span class="co">##  [1] LC_CTYPE=en_GB.UTF-8       LC_NUMERIC=C              </span></span>
<span><span class="co">##  [3] LC_TIME=en_GB.UTF-8        LC_COLLATE=en_GB.UTF-8    </span></span>
<span><span class="co">##  [5] LC_MONETARY=en_GB.UTF-8    LC_MESSAGES=en_GB.UTF-8   </span></span>
<span><span class="co">##  [7] LC_PAPER=en_GB.UTF-8       LC_NAME=C                 </span></span>
<span><span class="co">##  [9] LC_ADDRESS=C               LC_TELEPHONE=C            </span></span>
<span><span class="co">## [11] LC_MEASUREMENT=en_GB.UTF-8 LC_IDENTIFICATION=C       </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## time zone: Europe/Madrid</span></span>
<span><span class="co">## tzcode source: system (glibc)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## attached base packages:</span></span>
<span><span class="co">## [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## other attached packages:</span></span>
<span><span class="co">## [1] tidyselect_1.2.1  rlang_1.1.3       igraph_2.0.3      purrr_1.0.2      </span></span>
<span><span class="co">## [5] dplyr_1.1.4       magrittr_2.0.3    OmnipathR_3.11.10 BiocStyle_2.30.0 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## loaded via a namespace (and not attached):</span></span>
<span><span class="co">##  [1] tidyr_1.3.1         rappdirs_0.3.3      sass_0.4.9         </span></span>
<span><span class="co">##  [4] utf8_1.2.4          generics_0.1.3      xml2_1.3.6         </span></span>
<span><span class="co">##  [7] stringi_1.8.3       hms_1.1.3           digest_0.6.35      </span></span>
<span><span class="co">## [10] evaluate_0.23       timechange_0.3.0    bookdown_0.38      </span></span>
<span><span class="co">## [13] fastmap_1.1.1       cellranger_1.1.0    jsonlite_1.8.8     </span></span>
<span><span class="co">## [16] progress_1.2.3      backports_1.4.1     BiocManager_1.30.22</span></span>
<span><span class="co">## [19] rvest_1.0.4         httr_1.4.7          selectr_0.4-2      </span></span>
<span><span class="co">## [22] fansi_1.0.6         textshaping_0.3.7   jquerylib_0.1.4    </span></span>
<span><span class="co">## [25] cli_3.6.2           crayon_1.5.2        bit64_4.0.5        </span></span>
<span><span class="co">## [28] withr_3.0.0         cachem_1.0.8        yaml_2.3.8         </span></span>
<span><span class="co">## [31] parallel_4.3.2      tools_4.3.2         tzdb_0.4.0         </span></span>
<span><span class="co">## [34] memoise_2.0.1       checkmate_2.3.1     curl_5.2.1         </span></span>
<span><span class="co">## [37] vctrs_0.6.5         logger_0.3.0        R6_2.5.1           </span></span>
<span><span class="co">## [40] lifecycle_1.0.4     lubridate_1.9.3     stringr_1.5.1      </span></span>
<span><span class="co">## [43] bit_4.0.5           fs_1.6.3            vroom_1.6.5        </span></span>
<span><span class="co">## [46] ragg_1.2.7          pkgconfig_2.0.3     desc_1.4.3         </span></span>
<span><span class="co">## [49] pkgdown_2.0.7       pillar_1.9.0        bslib_0.6.1        </span></span>
<span><span class="co">## [52] later_1.3.2         glue_1.7.0          Rcpp_1.0.12        </span></span>
<span><span class="co">## [55] systemfonts_1.0.6   xfun_0.42           tibble_3.2.1       </span></span>
<span><span class="co">## [58] knitr_1.45          htmltools_0.5.7     rmarkdown_2.26     </span></span>
<span><span class="co">## [61] readr_2.1.5         compiler_4.3.2      prettyunits_1.2.0  </span></span>
<span><span class="co">## [64] readxl_1.4.3</span></span></code></pre>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Alberto Valdeolivas, Denes Turei, Attila Gabor.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
